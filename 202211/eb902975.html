<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>N1CTF2022 Crypto赛题复现 - zealot&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="zealot&#039;s blog"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="zealot&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="题目非常好，总共只有三道题，比赛时都卡在不同的地方没解出来。赛后看了一些大佬的思路尝试进行了复现，这里把复现的过程做一下记录和总结。"><meta property="og:type" content="article"><meta property="og:title" content="N1CTF2022 Crypto赛题复现"><meta property="og:url" content="https://litao6666.github.io/202211/eb902975.html"><meta property="og:site_name" content="zealot&#039;s blog"><meta property="og:description" content="题目非常好，总共只有三道题，比赛时都卡在不同的地方没解出来。赛后看了一些大佬的思路尝试进行了复现，这里把复现的过程做一下记录和总结。"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://litao6666.github.io/img/og_image.png"><meta property="article:published_time" content="2022-11-08T13:22:29.000Z"><meta property="article:modified_time" content="2022-11-09T07:39:26.232Z"><meta property="article:author" content="zealot"><meta property="article:tag" content="ecc"><meta property="article:tag" content="mt19937"><meta property="article:tag" content="lattice"><meta property="article:tag" content="dlp"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://litao6666.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://litao6666.github.io/202211/eb902975.html"},"headline":"zealot's blog","image":["https://litao6666.github.io/img/og_image.png"],"datePublished":"2022-11-08T13:22:29.000Z","dateModified":"2022-11-09T07:39:26.232Z","author":{"@type":"Person","name":"zealot"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject"}},"description":"题目非常好，总共只有三道题，比赛时都卡在不同的地方没解出来。赛后看了一些大佬的思路尝试进行了复现，这里把复现的过程做一下记录和总结。"}</script><link rel="canonical" href="https://litao6666.github.io/202211/eb902975.html"><meta name="referrer" content="no-referrer"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/js/globalUtils.min.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/live2d/waifu.min.css"><script type="text/javascript" async src="https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/live2d/autoload.min.js"></script><meta name="generator" content="Hexo 6.0.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">zealot&#039;s blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/LittleYe233/hexo-theme-amazingremake"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/js/theme-setting.min.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2022-11-08  <span class="level-item"><i class="far fa-clock"> </i>14 m  <i class="fas fa-pencil-alt"> </i>2.2 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">N1CTF2022 Crypto赛题复现</h1><div class="content"><p>题目非常好，总共只有三道题，比赛时都卡在不同的地方没解出来。赛后看了一些大佬的思路尝试进行了复现，这里把复现的过程做一下记录和总结。</p>
<span id="more"></span>
<h3 id="brand_new_checkin">brand_new_checkin</h3>
<p>从题目描述可以知道改题是基于<a
target="_blank" rel="noopener" href="https://github.com/theoremoon/cakectf2022-public/tree/master/crypto/brand_new_crypto">[CakeCTF2022]brand_new_crypto</a>的改编。题目源码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>():</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getrandbits(<span class="number">1024</span>)</span><br><span class="line">        b = phi + <span class="number">1</span> - a</span><br><span class="line"></span><br><span class="line">        s = getrandbits(<span class="number">1024</span>)</span><br><span class="line">        t = -s*a * inverse(b, phi) % phi</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> GCD(b, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> (s, t, n), (a, b, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m, k</span>):</span><br><span class="line">    s, t, n = k</span><br><span class="line">    r = getrandbits(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m * <span class="built_in">pow</span>(r, s, n) % n, m * <span class="built_in">pow</span>(r, t, n) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pubkey, privkey = keygen()</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">pow</span>(bytes_to_long(flag), <span class="number">0x10001</span>, pubkey[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> long_to_bytes(flag):</span><br><span class="line">    c1, c2 = enc(m, pubkey)</span><br><span class="line">    c.append((c1, c2))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pubkey)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>
<p>与原题的区别在于，在原题加密方式的前面，多了一层rsa的加密。</p>
<p>首先肯定得拿到rsa加密的密文。我们观察到程序中是逐字节进行的enc操作，那么这为我们按字节逐个爆破提供了可能。那么怎么去爆破呢？（其实这一部分在网上已经有题解了，有多种做法）</p>
<p>根据题目有： <span class="math display">\[
s*a+t*b=0 \mod phi \\
a+b=1+phi\\
c_1=m*r^s \mod n \\
c_2=m*r^t \mod n \\
\]</span> (s, t)是公钥，(a,
b)是私钥。由于产生密文时，r是随机数未知的，因此考虑消去r的影响。做如下计算：
<span class="math display">\[
{c_1}^t*({c_2}^s)^{-1}=m^{t-s} \mod n
\]</span>
因此爆破单字节m的256种可能情况去验证该等式即可。然后就能拿到rsa的密文。</p>
<p>然而题目似乎没有给出更多有用的能够去分解n的信息，a和b也不能求出来。到这里我当时的思路就没有了。进行了一些尝试，可以求出每次r的值，但好像也无济于事。</p>
<p>赛后看别人的思路一瞬间就懂了，我是真滴眼瞎，这么多个getrandbits我没注意到，这不是妥妥的mt19937随机数预测吗。再扫一眼题目，r是1024bits可以计算，且足够多，那就确认无疑了。</p>
<p>然后是关于r的计算。这里由于s和t是互质的，我们可以通过扩展欧几里得算法计算出使得<span
class="math inline">\(s*A+t*B=1\)</span>的A和B。然后做如下计算： <span
class="math display">\[
{c_1}^A*{c_2}^B=m^{A+B}*r^{s*A+t*B}=m^{A+B}*r \mod n\\
\Rightarrow r={c_1}^A*{c_2}^B*(m^{A+B})^{-1} \mod n
\]</span>
因此我们可以拿到计算每一个字节m所使用的r。为了进行预测，我们需要<span
class="math inline">\(624/(1024/32)=19.5\)</span>个r的值，然而实际计算出的数量远比这个多，已经足够了，取前20个即可。</p>
<p>复现时发现这里还有一个比较坑的点，这里的r是模n下计算出来的，而实际r产生时虽然与n一样是1024bits，但和n没有任何关系，也就是说r是可能大于n的。因此这里算出的r有小概率不是准确值，对于每个r需要在1024bits范围内进行小规模的枚举爆破。</p>
<p>然后本题的随机数预测是一个后向的，用到的是<a
target="_blank" rel="noopener" href="https://github.com/NonupleBroken/ExtendMT19937Predictor">ExtendMT19937Predictor</a>。可以通过s来进行验证预测是否正确，然后得到a的值。然后能计算出一个phi的倍数：
<span class="math display">\[
s*a+t*b=0 \mod phi \\
\Rightarrow s*a+t*(1+phi-a)=0 \mod phi \\
\Rightarrow s*a+t*(1-a)=k*phi
\]</span> 用<span
class="math inline">\(k*phi\)</span>求私钥d，解rsa即可得到flag。</p>
<p>复现解题脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_pow</span>(<span class="params">m,e,n</span>):</span><br><span class="line">    <span class="keyword">if</span> e&lt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> inverse(<span class="built_in">pow</span>(m,-e,n),n)%n</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">lines=<span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line">s,t,n=<span class="built_in">eval</span>(lines[<span class="number">0</span>])</span><br><span class="line">c=<span class="built_in">eval</span>(lines[<span class="number">1</span>])</span><br><span class="line">g,A,B=gcdext(s,t)</span><br><span class="line"></span><br><span class="line">encflag=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c1,c2 <span class="keyword">in</span> c:</span><br><span class="line">    tmp=<span class="built_in">pow</span>(c1,t,n)*inverse(<span class="built_in">pow</span>(c2,s,n),n)%n</span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> my_pow(m,t-s,n)==tmp:</span><br><span class="line">            encflag.append(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">encflag=bytes_to_long(<span class="built_in">bytes</span>(encflag))</span><br><span class="line"><span class="built_in">print</span>(encflag)</span><br><span class="line"><span class="comment">#5808031027043628162680151939451046896318461702606899637261519628597633638670331617408988305725962951563713997335461555788456061664507614271209312052190146070886646800923406401095648933383421520598567936442062181397887455263188256755970400658783406029792373329955006020555525415893643918145187677700370550761</span></span><br><span class="line"></span><br><span class="line">encflag=<span class="number">5808031027043628162680151939451046896318461702606899637261519628597633638670331617408988305725962951563713997335461555788456061664507614271209312052190146070886646800923406401095648933383421520598567936442062181397887455263188256755970400658783406029792373329955006020555525415893643918145187677700370550761</span></span><br><span class="line">mlist=<span class="built_in">list</span>(long_to_bytes(encflag))</span><br><span class="line">possible_rlist=[]</span><br><span class="line"><span class="keyword">for</span> m,cc <span class="keyword">in</span> <span class="built_in">zip</span>(mlist,c):</span><br><span class="line">    c1,c2=cc</span><br><span class="line">    tmpr=<span class="built_in">int</span>(my_pow(c1,A,n)*my_pow(c2,B,n)*inverse(my_pow(m,A+B,n),n)%n)</span><br><span class="line">    <span class="keyword">assert</span> c1==m*<span class="built_in">pow</span>(tmpr,s,n)%n</span><br><span class="line">    <span class="keyword">assert</span> c2==m*<span class="built_in">pow</span>(tmpr,t,n)%n</span><br><span class="line">    <span class="keyword">if</span> tmpr==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    tmprlist=[]</span><br><span class="line">    <span class="keyword">while</span> tmpr.bit_length()&lt;=<span class="number">1024</span>:</span><br><span class="line">        tmprlist.append(tmpr)</span><br><span class="line">        tmpr+=n</span><br><span class="line">    possible_rlist.append(tmprlist)</span><br><span class="line"></span><br><span class="line"><span class="comment">#624/(1024/32)=19.5</span></span><br><span class="line">possible_rlist=possible_rlist[:<span class="number">20</span>]</span><br><span class="line"><span class="keyword">for</span> rlist <span class="keyword">in</span> tqdm(product(*possible_rlist)):</span><br><span class="line">    predictor=ExtendMT19937Predictor()</span><br><span class="line">    <span class="comment">#624=19*(1024/32)+(512/32)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">        predictor.setrandbits(rlist[i],<span class="number">1024</span>)</span><br><span class="line">    predictor.setrandbits(rlist[<span class="number">19</span>]&amp;(<span class="number">2</span>**<span class="number">512</span>-<span class="number">1</span>),<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        predictor.backtrack_getrandbits(<span class="number">32</span>)</span><br><span class="line">    guess_s=predictor.backtrack_getrandbits(<span class="number">1024</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> guess_s==s:</span><br><span class="line">        a=predictor.backtrack_getrandbits(<span class="number">1024</span>)</span><br><span class="line">        k_phi=s*a+t*(<span class="number">1</span>-a)</span><br><span class="line">        d=inverse(<span class="number">0x10001</span>,k_phi)</span><br><span class="line">        flag=long_to_bytes(<span class="built_in">pow</span>(encflag,d,n))</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#b&#x27;n1ctf&#123;5255840f-9140-4479-950f-a3c03fe7f4cd&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezdlp">ezdlp</h3>
<p>题目源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">pbits,kbits,k</span>):</span><br><span class="line">    p = getPrime(pbits)</span><br><span class="line">    x = [getPrime(kbits + <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line">    y = prod(x)</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        r = getPrime(pbits - kbits * k)</span><br><span class="line">        q = <span class="number">2</span> * y * r + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">return</span> p*q, (p, q, r, x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">key, message</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="number">0x10001</span>, message, key)</span><br><span class="line"></span><br><span class="line">key = keygen(<span class="number">512</span>, <span class="number">24</span>, <span class="number">20</span>)</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">messages = [getPrime(flag.bit_length()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">47</span>)] + [flag]</span><br><span class="line">enc = [encrypt(key[<span class="number">0</span>], message) <span class="keyword">for</span> message <span class="keyword">in</span> messages]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(messages[:-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure>
<p>可以观察到q-1是光滑数，然而题目并没有给出<span
class="math inline">\(n=p*q\)</span>的值，需要先从47组(m,
c)中求出n。由于模数n未知，无法直接做模幂运算，也不能直接对一个大数求幂。因此需要用间接法构造出具有因子n的式子。</p>
<p>我们先看最简单的情况，假设有<span
class="math inline">\(c_1=e^{m_1}\mod n\)</span>, <span
class="math inline">\(c_2=e^{m_2}\mod n\)</span>, 如果<span
class="math inline">\(m_1\)</span>与<span
class="math inline">\(m_2\)</span>非常接近（假设<span
class="math inline">\(m_1&gt;m_2\)</span>）, 那么就有<span
class="math inline">\(c_2*e^{m_1-m_2}=c_1 \mod n\)</span>, 也即是<span
class="math inline">\(c_2*e^{m_1-m_2}-c_1=k*n\)</span>。通过构造一个比较小的差值来避免了大指数的幂运算。</p>
<p>借用以上思路，回到本题中，我们可以考虑m的线性组合<span
class="math inline">\(t=k_1*m_1+k_2*m_2+...+k_l*m_l\)</span>，使t为一个比较小的值，且系数<span
class="math inline">\(k_i\)</span>也比较小，从而便于我们计算<span
class="math inline">\(e^t=e^{k_1*m_1+k_2*m_2+...+k_l*m_l}=c_1^{k_1}*c_2^{k_2}*...*c_l^{k_l}\)</span>。这种形式就很熟悉了，可以转化为一个格中的最短向量问题来求解。因此，可以构造如下格矩阵：
<span class="math display">\[
M=\begin{bmatrix}
1 &amp; 0 &amp; ... &amp; 0 &amp; 0 &amp; m_1 \\
0 &amp; 1 &amp; ... &amp; 0 &amp; 0 &amp; m_2 \\
... &amp; ... &amp; ...  &amp; ... &amp; ... &amp; ...\\
0 &amp; 0 &amp; ... &amp; 1 &amp; 0 &amp; m_{l-1} \\
0 &amp; 0 &amp; ... &amp; 0 &amp; 1 &amp; m_l \\
\end{bmatrix}
\]</span> 通过格基规约，我们可以得到一组短向量<span
class="math inline">\(v=(k_1,k_2,...k_l,t)\)</span>，通过观察发现规约出的这一组向量都能用于计算。但注意向量中会有负数出现，由于没有n无法求模逆，需要将正数和负数分开计算。然后每一个向量都能求出一个<span
class="math inline">\(k*n\)</span>, 求gcd即可得到n的值。</p>
<p>求出n之后就比较好办了，由于q-1光滑，可以使用Pollard's p-1
方法对n进行分解。然后使用Pohlig-Hellman算法来求解dlp。</p>
<p>在实际操作时，gcd求出的n会带有一些小素数因子，需要先除掉这些因子得到应该是1034bits的n。然后，在使用Pollard's
p-1
分解n时，可以直接使用yafu的pm1来分解，不过需要设置一下bound，根据题目参数可以设置为(<span
class="math inline">\(2^{25}\)</span>, <span
class="math inline">\(2^{32}\)</span>)。此外sagemath中的discrete_log方法自带Pohlig-Hellman算法，可以直接使用。</p>
<p>复现整个解题过程如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">lines=<span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line">messages=<span class="built_in">eval</span>(lines[<span class="number">0</span>])</span><br><span class="line">enc=<span class="built_in">eval</span>(lines[<span class="number">1</span>])</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">l=<span class="built_in">len</span>(messages)</span><br><span class="line"></span><br><span class="line">m=matrix(ZZ,l,l+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">	m[i,i]=<span class="number">1</span></span><br><span class="line">	m[i,l]=messages[i]</span><br><span class="line">ml=m.LLL()</span><br><span class="line"><span class="comment">#print(ml)</span></span><br><span class="line">kn=[]</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> ml:</span><br><span class="line">	v=vector(ZZ,row[:-<span class="number">1</span>])</span><br><span class="line">	mes=vector(ZZ,messages)</span><br><span class="line">	<span class="keyword">assert</span> v*mes==row[-<span class="number">1</span>]</span><br><span class="line">	t1,t2=<span class="number">0</span>,<span class="number">0</span></span><br><span class="line">	s1,s2=<span class="number">1</span>,<span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(row[:-<span class="number">1</span>])):</span><br><span class="line">		<span class="keyword">if</span> row[i]&gt;<span class="number">0</span>:</span><br><span class="line">			t1+=messages[i]*row[i]</span><br><span class="line">			s1*=enc[i]^row[i]</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			t2+=messages[i]*(-row[i])</span><br><span class="line">			s2*=enc[i]^(-row[i])</span><br><span class="line">	<span class="keyword">if</span> row[-<span class="number">1</span>]&lt;<span class="number">0</span>:</span><br><span class="line">		t1+=(-row[-<span class="number">1</span>])</span><br><span class="line">		s1*=e^(-row[-<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		t2+=row[-<span class="number">1</span>]</span><br><span class="line">		s2*=e^row[-<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">if</span> t1&lt;t2:</span><br><span class="line">		kn.append(s1*e^(t2-t1)-s2)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		kn.append(s2*e^(t1-t2)-s1)</span><br><span class="line"></span><br><span class="line">n=gcd(kn)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">49611284910337799636686093973628884556519420722411744808788041251053464830295020698422734325291979154664020667752312689941156441913588062021033819091827109198856404394033383330790178899747263327203370892584838961198767774504917946326930691665376634864787990599380909937268721753630966833756746550396165568643515524639508308583115086758244593451557057086091631335435790943219993697350307236788433226079650671638629500149333590709610544282138758930744076756362806343446562260731142938656726337673043604423108674514420668104284015023085322240000000000000000000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">div by small primes</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">131158523227880830085100826212925738665356578827561846263073537503153187073136528966506785633847097997799377037969243883439723340886038624250936927221630287086602285835045356221763554989140952262353930420392663280482277832613695689454662506372252641564106136178637816827646124189347219273164844809807934422046441</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">n=<span class="number">131158523227880830085100826212925738665356578827561846263073537503153187073136528966506785633847097997799377037969243883439723340886038624250936927221630287086602285835045356221763554989140952262353930420392663280482277832613695689454662506372252641564106136178637816827646124189347219273164844809807934422046441</span></span><br><span class="line">c=enc[-<span class="number">1</span>]</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">yafu pm1(131158523227880830085100826212925738665356578827561846263073537503153187073136528966506785633847097997799377037969243883439723340886038624250936927221630287086602285835045356221763554989140952262353930420392663280482277832613695689454662506372252641564106136178637816827646124189347219273164844809807934422046441) -B1pm1 33554432 -B2pm1 4294967296</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">p=<span class="number">10104420349837363561278745998119091841853342383118385156657416134976061697027571349895988817770681767227605656666215380267313369652920490697343475330713803</span></span><br><span class="line">q=<span class="number">12980311456459934558628309999285260982188754011593109633858685687007370476504059552729490523256867881534711749584157463076269599380216374688443704196597025947</span></span><br><span class="line">res=discrete_log(mod(c,q),mod(e,q))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(res))</span><br><span class="line"><span class="string">b&#x27;n1ctf&#123;1f1b18f9-8523-4584-a8eb-c8b5c9c9433d&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="babyecc">babyecc</h3>
<p>题目源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = Integer(<span class="built_in">int</span>.from_bytes(flag, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            a = randint(<span class="number">0</span>,n)</span><br><span class="line">            b = randint(<span class="number">0</span>,n)</span><br><span class="line">            Ep = EllipticCurve(GF(p), [a,b])</span><br><span class="line">            Gp = Ep.lift_x(m) * <span class="number">2</span></span><br><span class="line">            Eq = EllipticCurve(GF(q), [a,b])</span><br><span class="line">            Gq = Eq.lift_x(m) * <span class="number">2</span></span><br><span class="line">            y = crt([<span class="built_in">int</span>(Gp[<span class="number">1</span>]),<span class="built_in">int</span>(Gq[<span class="number">1</span>])],[p,q])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(n, a, b, y)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>题目代码很简单就不多作描述了。可以观察到，每一次加密使用的是相同的m，不同的a,
b,
n。因此可以类比于RSA中的Hastad广播攻击，主要的思想是计算多项式并求crt，然后求根。</p>
<p>这题的主要关键点在于y和m之间关系的一个推导。比赛时就因为这一步出了问题推错了，然后就卡住了。赛后复现又重新推了一遍这个过程，这里把推理过程写一下。</p>
<p>首先假设<span class="math inline">\(P=(m,y_m)\)</span>，<span
class="math inline">\(G=2*P=(G_x,G_y)\)</span>。然后我们根据椭圆曲线公式及点的倍乘关系有：
<span class="math display">\[
{y_m}^2=m^3+a*m+b \\
\lambda={ {3*m^2+a} \over {2*y_m} } \\
G_x=\lambda^2-2*m \\
G_y=\lambda*(m-G_x)-y_m=3*\lambda*m-\lambda^3-y_m
\]</span> 然后把相关变量代入到<span
class="math inline">\(G_y\)</span>中： <span class="math display">\[
G_y={ {3*m*(3*m^2+a)} \over {2*y_m} }-{ {(3*m^2+a)^3} \over {8*{y_m}^3}
}-y_m \\
\Rightarrow 8*{y_m}^3*G_y=12*m*{y_m}^2*(3*m^2+a)-(3*m^2+a)^3-8*{y_m}^4
\\
\]</span> 为了消掉<span
class="math inline">\(y_m\)</span>，需要凑出偶数次幂。式子左边有<span
class="math inline">\({y_m}^3\)</span>，右边可以直接代入<span
class="math inline">\({y_m}^2\)</span>，因此需要两边平方。记： <span
class="math display">\[
f={y_m}^2=m^3+a*m+b\\
g=3*m^2+a \\
l=(8*{y_m}^3*G_y)^2=64*f^3*{G_y}^2 \\
r=12*m*f*g-g^3-8*f^2
\]</span> 因此上面的式子可以简写转化为: <span class="math display">\[
F_i(m)=l-r^2=0 \mod n_i
\]</span> 其中，除了m之外的变量全部已知。</p>
<p>我们根据这个关系，可以得到7个不同域上的多项式<span
class="math inline">\(F_i(m)=0 \mod
n_i\)</span>。然后计算这7个多项式的crt得到<span
class="math inline">\(G(m)=0 \mod N\)</span>，其中<span
class="math inline">\(N=\prod n_i\)</span>，<span
class="math inline">\(G(m)\)</span>的系数由<span
class="math inline">\(F_i(m)\)</span>的对应项系数crt计算得出。<span
class="math inline">\(N\)</span>为7*1024bits，而m大概为344bits（8bits*43，根据flag格式特征），因此可以用small_roots求解。</p>
<p>注意多项式G为12阶，根据coppersmith相关参数的意义，在实际试验过程中，epsilon大概小于0.04左右才能得到结果。</p>
<p>复现解题脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">lines=<span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line"></span><br><span class="line">enc=[<span class="built_in">tuple</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,lines[i].strip().split(<span class="string">&#x27; &#x27;</span>))) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)]</span><br><span class="line">coeffi=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">	n,a,b,y=enc[i]</span><br><span class="line">	R.&lt;x&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">	f=x^<span class="number">3</span>+a*x+b</span><br><span class="line">	g=<span class="number">3</span>*x^<span class="number">2</span>+a</span><br><span class="line">	l=<span class="number">64</span>*f^<span class="number">3</span>*y^<span class="number">2</span></span><br><span class="line">	r=<span class="number">12</span>*x*f*g-g^<span class="number">3</span>-<span class="number">8</span>*f^<span class="number">2</span></span><br><span class="line">	F=l-r^<span class="number">2</span></span><br><span class="line">	coeffi.append(F.monic())</span><br><span class="line"></span><br><span class="line">deg=<span class="number">12</span></span><br><span class="line">ns=[ enc[i][<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc))]</span><br><span class="line">N=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> ns:</span><br><span class="line">    N*=n</span><br><span class="line"></span><br><span class="line">Crtlist=[[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)] <span class="keyword">for</span> __ <span class="keyword">in</span> <span class="built_in">range</span>(deg+<span class="number">1</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(deg+<span class="number">1</span>):</span><br><span class="line">        Crtlist[j][i]=ZZ(coeffi[i][j])</span><br><span class="line"></span><br><span class="line">A=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(deg+<span class="number">1</span>):</span><br><span class="line">    A.append(CRT(Crtlist[i],ns))</span><br><span class="line"></span><br><span class="line">R.&lt;m&gt;=PolynomialRing(Zmod(N))</span><br><span class="line">G=R(A)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Finding Roots&#x27;</span>)</span><br><span class="line">res=G.small_roots(X=<span class="number">2</span>^<span class="number">350</span>,epsilon=<span class="number">1</span>/<span class="number">25</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(res)&gt;<span class="number">0</span>:</span><br><span class="line">	<span class="built_in">print</span>(res)</span><br><span class="line">	<span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(res[<span class="number">0</span>])))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;No solution found.&#x27;</span>)</span><br><span class="line"><span class="comment">#b&#x27;n1ctf&#123;7140f171-5fb5-484d-92f4-9f7ba02c33d0&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>N1CTF2022 Crypto赛题复现</p><p><a href="https://litao6666.github.io/202211/eb902975.html">https://litao6666.github.io/202211/eb902975.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><a href="https://litao6666.github.io"><p>zealot</p></a></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2022-11-08</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-11-09</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/202212/4446a1ac.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">RCTF2022 Crypto部分wp</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/202210/b48e4a69.html"><span class="level-item">NewStarCTF Blockchain Week4 wp</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#brand_new_checkin"><span>brand_new_checkin</span></a></li><li><a class="is-flex is-mobile" href="#ezdlp"><span>ezdlp</span></a></li><li><a class="is-flex is-mobile" href="#babyecc"><span>babyecc</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">zealot&#039;s blog</a><p class="size-small"><span>&copy; 2023 zealot</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noreferrer">Icarus</a> &amp; <a href="https://github.com/LittleYe233/hexo-theme-amazingremake" target="_blank" rel="noreferrer">Amazing-Remake</a> <br><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><div class="size-small"><span>❤️Thx <strong><span id="busuanzi_value_site_uv">99+</span></strong> users <strong><span id="busuanzi_value_site_pv">99+</span></strong> visited!❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/LittleYe233/hexo-theme-amazingremake"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    enabled: true,
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/js/column.min.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/js/main.min.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { // 加载mathjax
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$']],
                    autoload: {
                        color: [],
                        colorv2: ['color']
                    },
                    packages: {'[+]': ['noerrors']}
                },
                options: {
                    ignoreHtmlClass: 'tex2jax_ignore',
                    processHtmlClass: 'tex2jax_process'
                },
                loader: {
                    load: ['input/asciimath', '[tex]/noerrors']
                }
            };
            $.getScript('//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js');
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('https://cdn.jsdelivr.net/gh/litao6666/litao6666.github.io/js/comment-issue-data.min.js',function(){loadIssueData('','','','',false);});
            }
            if('undefined' === 'mathjax'){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>